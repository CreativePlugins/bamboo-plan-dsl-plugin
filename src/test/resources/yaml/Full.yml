project:
  key: MYPROJECT
  name: This is my project
  plans:
    - key: MYPLAN
      name: my plan
      notifications:
        - !email
          address: test@test.com
          event: !event ALL_BUILDS_COMPLETED
      triggers:
        - !scheduled
          description: run every day at noon
          cronExpression: 0 0 0 ? * *
      scm:
        - !bitbucket
          repoSlug: repo1
          branch: master
          authType: !password
            userName: user
            password: pw
      stages:
        - name: mystage
          jobs:
            - key: MYJOB
              name: myjob
              tasks:
                - !script
                  inlineScript:
                    scriptBody: !env mykey
                - !custom
                  pluginKey: ch.mibex.bamboo.plandsl
                  taskConfig:
                    key1: value1
                    key2: value2
              artifactDependencies:
                - name: myExe
                  destinationDirectory: targets
              artifactDefinitions:
                - location: mydir
                  copyPattern: '*.exe'
                  isShared: true
                  name: def
      branches:
        autoBranchManagement:
          deletePlanBranchesAfterDays: 2
          deletedBranchesStrategy: !deletedBranches DO_NOT_DELETE_PLAN_BRANCHES
          inactiveBranchesStrategy: !inactiveBranches DELETE_INACTIVE_PLAN_BRANCHES_AFTER_DAYS
          deleteInactivePlanBranchesAfterDays: 3
          newBranchesStrategy: !newBranches NEW_PLAN_BRANCHES_FOR_MATCHING_BRANCH_NAMES
          matchingBranchesRegex: '.*'
        branchMerging:
          mergeStrategy: !gateKeeper
            planBranchKey: PLANKEY
            pushEnabled: false
        branches:
          - name: feature_1234
            vcsBranchName: feature/1234
            description: my important feature branch
            cleanupAutomatically: true
            triggers:
              - !bitbucketServerTrigger
                description: run when push
      deploymentProjects:
        - id: 1
          name: DP1
          description: my deployment project
          useCustomPlanBranch: develop
          environments:
            - name: staging
              id: 1
              description: Staging env
            - name: prod
              id: 2
              description: Production env
              tasks:
                - !script
                  inlineScript:
                    scriptBody: !env mykey2
              variables:
                - key: myKey1
                  value: myValue1
                - key: myKey2
                  value: myValue2
              notifications:
                 - !hipchat
                   apiToken: ABC
                   room: myroom
                   event: !event DEPLOYMENT_FAILED
          releaseVersioning:
             nextReleaseVersion: 1.0.0
             autoIncrement: true
             variables:
               - var1
               - var2
          permissions:
            user:
              bob: !permission VIEW
              carol: !permission EDIT
            group:
              devops: !permission ADMIN
            other:
              !userType LOGGED_IN_USERS: !permission VIEW